# KaiBrain 开发路线图

## 当前状态评估

**版本**: 0.1.0-alpha  
**总体完成度**: ~35%  
**可运行性**: 框架可启动，无实际功能

---

## Phase 1: 核心可用 (P0 - 必须完成)

目标：系统可以接收指令，通过LLM推理，执行基本工具，返回结果

### 1.1 Agent运行时完善 [开发]
**负责人**: ___  
**预计工作量**: 3-5天

- [ ] `agent/runtime/agent_loop.py` - 完善Agent主循环
  - [ ] 实现错误恢复机制
  - [ ] 添加超时处理
  - [ ] 实现重试逻辑
- [ ] `agent/runtime/tool_executor.py` - 工具执行器
  - [ ] 实现工具调用队列
  - [ ] 添加执行结果缓存
  - [ ] 实现并发执行控制
- [ ] `agent/runtime/context_builder.py` - 上下文构建
  - [ ] 实现上下文裁剪（超长时截断）
  - [ ] 添加历史消息管理

### 1.2 工具系统完善 [开发]
**负责人**: ___  
**预计工作量**: 2-3天

- [ ] `system/tools/builtin/shell.py` - Shell工具
  - [ ] 实现命令白名单/黑名单
  - [ ] 添加执行超时控制
  - [ ] 实现输出截断
- [ ] `system/tools/builtin/http.py` - HTTP工具
  - [ ] 实现GET/POST请求
  - [ ] 添加响应解析
  - [ ] 实现请求限流

### 1.3 数据持久化 [开发]
**负责人**: ___  
**预计工作量**: 3-4天

- [ ] `data/storage/relational.py` - SQLite适配器
  - [ ] 实现基础CRUD
  - [ ] 添加连接池
- [ ] `data/explicit/workflow_memory.py` - 持久化
  - [ ] 实现SQLite存储
  - [ ] 添加加载/保存逻辑
- [ ] `data/explicit/entity_memory.py` - 持久化
  - [ ] 实现SQLite存储

### 1.4 集成测试 [测试]
**负责人**: ___  
**预计工作量**: 2天

- [ ] 端到端测试：用户输入 → LLM推理 → 工具调用 → 返回结果
- [ ] 性能基准测试

**Phase 1 交付标准**:
- [ ] 可以通过命令行与系统对话
- [ ] 可以执行文件读写、简单Shell命令
- [ ] 对话历史可持久化

---

## Phase 2: Agent协作 (P1)

目标：多Agent协作，任务编排，子Agent调度

### 2.1 编排系统完善 [开发]
**负责人**: ___  
**预计工作量**: 4-5天

- [ ] `agent/orchestrator/task_decomposer.py`
  - [ ] 实现LLM驱动的任务拆解
  - [ ] 添加任务模板学习
- [ ] `agent/orchestrator/flow_controller.py`
  - [ ] 实现条件分支执行
  - [ ] 添加失败回滚
  - [ ] 实现并行任务聚合

### 2.2 子Agent系统 [开发]
**负责人**: ___  
**预计工作量**: 3-4天

- [ ] `agent/subagent/spawn.py` - 子Agent生成
  - [ ] 实现动态Agent创建
  - [ ] 添加资源限制
- [ ] `agent/subagent/subagent_manager.py` - 管理
  - [ ] 实现子Agent生命周期管理
  - [ ] 添加结果聚合

### 2.3 安全权限 [开发]
**负责人**: ___  
**预计工作量**: 2-3天

- [ ] `agent/security/tool_policy.py`
  - [ ] 实现工具权限检查
  - [ ] 添加危险操作确认
- [ ] `agent/security/permission.py`
  - [ ] 实现Agent权限模型

**Phase 2 交付标准**:
- [ ] Super Agent可以调度多个子Agent
- [ ] 复杂任务可自动拆解执行
- [ ] 权限控制生效

---

## Phase 3: 技能系统 (P1)

目标：实现可复用的技能模块

### 3.1 技能框架 [开发]
**负责人**: ___  
**预计工作量**: 3-4天

- [ ] `skills/base.py` - 完善技能基类
  - [ ] 实现技能参数验证
  - [ ] 添加技能版本管理
  - [ ] 实现技能组合
- [ ] `skills/registry.py` - 技能注册
  - [ ] 实现动态技能发现
  - [ ] 添加技能依赖管理

### 3.2 基础技能实现 [开发]
**负责人**: ___  
**预计工作量**: 5-7天

- [ ] 文件管理技能
- [ ] 代码分析技能
- [ ] 信息检索技能
- [ ] 文本处理技能

**Phase 3 交付标准**:
- [ ] 至少5个可用技能
- [ ] 技能可动态加载
- [ ] 技能可组合执行

---

## Phase 4: 数据智能 (P2)

目标：实现知识图谱、向量检索、工作流学习

### 4.1 知识图谱 [开发]
**负责人**: ___  
**预计工作量**: 4-5天

- [ ] `data/explicit/knowledge_graph.py`
  - [ ] 集成Neo4j（可选）
  - [ ] 实现图遍历查询
  - [ ] 添加关系推理

### 4.2 向量检索 [开发]
**负责人**: ___  
**预计工作量**: 3-4天

- [ ] `data/storage/vector.py` - ChromaDB适配器
  - [ ] 实现向量存储
  - [ ] 添加相似度搜索
- [ ] 实体记忆向量化
- [ ] 工作流相似度匹配

### 4.3 工作流学习 [开发]
**负责人**: ___  
**预计工作量**: 4-5天

- [ ] 实现工作流成功率统计
- [ ] 添加Agent链推荐
- [ ] 实现自动优化建议

**Phase 4 交付标准**:
- [ ] 支持语义搜索
- [ ] 知识图谱可查询
- [ ] 工作流可学习优化

---

## Phase 5: 硬件集成 (P2)

目标：实现ROS2通信、硬件抽象

### 5.1 ROS2集成 [开发]
**负责人**: ___  
**预计工作量**: 5-7天  
**前置条件**: ROS2环境

- [ ] `middleware/cerebellum_pipeline/ros2_node.py`
  - [ ] 实现实际ROS2节点
  - [ ] 添加话题发布/订阅
  - [ ] 实现服务调用
- [ ] `system/brain_pipeline/bridge.py`
  - [ ] 实现大脑-小脑消息转换
  - [ ] 添加状态同步

### 5.2 硬件抽象实现 [开发]
**负责人**: ___  
**预计工作量**: 5-7天  
**前置条件**: 硬件设备

- [ ] `hardware/interfaces/sensors.py` - 传感器实现
- [ ] `hardware/interfaces/actuators.py` - 执行器实现
- [ ] 驱动适配层

### 5.3 隐性数据管理 [开发]
**负责人**: ___  
**预计工作量**: 3-4天

- [ ] Policy加载系统
- [ ] URDF解析
- [ ] 机械参数校验

**Phase 5 交付标准**:
- [ ] 可与ROS2系统通信
- [ ] 传感器数据可读取
- [ ] 控制指令可发送

---

## Phase 6: 生产就绪 (P3)

目标：监控、日志、部署、文档

### 6.1 可观测性 [开发]
- [ ] Prometheus指标导出
- [ ] 结构化日志
- [ ] 分布式追踪

### 6.2 部署 [运维]
- [ ] Docker镜像
- [ ] Kubernetes部署
- [ ] CI/CD流水线

### 6.3 文档 [产品]
- [ ] API文档
- [ ] 部署文档
- [ ] 开发者指南

---

## 优先级说明

| 优先级 | 说明 |
|--------|------|
| P0 | 必须完成，阻塞所有后续工作 |
| P1 | 核心功能，产品可用的前提 |
| P2 | 重要功能，提升系统能力 |
| P3 | 生产所需，非功能性需求 |

---

## 里程碑

| 里程碑 | 目标 | 预计时间 |
|--------|------|----------|
| M1 | Phase 1 完成，系统可交互 | +2周 |
| M2 | Phase 2-3 完成，多Agent协作 | +4周 |
| M3 | Phase 4 完成，智能数据 | +3周 |
| M4 | Phase 5 完成，硬件集成 | +4周 |
| M5 | Phase 6 完成，生产就绪 | +3周 |

**总计**: 约16周（4个月）达到生产可用

---

## 技术债务清单

| 位置 | 问题 | 影响 |
|------|------|------|
| `agent/runtime/*.py` | 多处`pass`占位 | 运行时不完整 |
| `hardware/*.py` | 全部为抽象接口 | 无法控制硬件 |
| `middleware/ros2_node.py` | ROS2调用为模拟 | 无实际通信 |
| `data/explicit/*.py` | 无持久化 | 重启丢失数据 |
| 全局 | 无单元测试 | 质量风险 |
| 全局 | 无错误处理标准 | 运行时崩溃 |

---

## 会议/同步

- [ ] 周例会：进度同步，问题讨论
- [ ] 代码评审：PR必须review
- [ ] 技术分享：关键设计决策记录
